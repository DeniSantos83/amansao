<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>A MANSÃO — Livro-jogo</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <canvas id="rain"></canvas>
  <div id="lightning" aria-hidden="true"></div>

  <header class="topbar">
    <div class="brand">
      <div class="title">A MANSÃO</div>
      <div class="subtitle">Livro-jogo • sem voltar • sem reset no refresh</div>
    </div>

    <div class="hud">
      <div class="hud__row">
        <div class="hud__item"><span class="k">Nome</span><span class="v" id="hudName">—</span></div>
        <div class="hud__item"><span class="k">Cena</span><span class="v" id="hudScene">—</span></div>
      </div>

      <div class="hud__row">
        <div class="hud__item"><span class="k">HABIL</span><span class="v" id="hudSkill">—</span></div>
        <div class="hud__item"><span class="k">VIGOR</span><span class="v" id="hudStam">—</span></div>
        <div class="hud__item"><span class="k">SORTE</span><span class="v" id="hudLuck">—</span></div>
        <div class="hud__item"><span class="k">MEDO</span><span class="v" id="hudFear">—</span></div>
      </div>
    </div>

    <div class="actions">
      <button class="btn btn--ghost" id="btnRules" type="button">Regras</button>
      <button class="btn btn--danger" id="btnRestart" type="button">Recomeçar</button>
    </div>
  </header>

  <main class="wrap">
    <section class="panel" id="screenCreate" hidden>
      <h1>Criar personagem</h1>
      <p class="muted">Role os dados e monte sua ficha. O jogo salva automaticamente no seu navegador.</p>

      <div class="grid">
        <label class="field">
          <span>Nome</span>
          <input id="inpName" type="text" placeholder="Digite seu nome..." autocomplete="off" />
        </label>

        <div class="field">
          <span>HABILIDADE (máx)</span>
          <div class="row">
            <input id="inpSkillMax" type="number" min="0" readonly />
            <button class="btn" id="rollSkill" type="button">Rolar 1d6 + 6</button>
          </div>
          <small class="hint">Você começa sem arma: HABILIDADE Inicial = HABILIDADE − 3</small>
        </div>

        <div class="field">
          <span>HABILIDADE (inicial / desarmado)</span>
          <input id="inpSkillCur" type="number" min="0" readonly />
        </div>

        <div class="field">
          <span>RESISTÊNCIA (máx)</span>
          <div class="row">
            <input id="inpStamMax" type="number" min="0" readonly />
            <button class="btn" id="rollStam" type="button">Rolar 1d6 + 12</button>
          </div>
        </div>

        <div class="field">
          <span>RESISTÊNCIA (atual)</span>
          <input id="inpStamCur" type="number" min="0" readonly />
        </div>

        <div class="field">
          <span>SORTE (máx)</span>
          <div class="row">
            <input id="inpLuckMax" type="number" min="0" readonly />
            <button class="btn" id="rollLuck" type="button">Rolar 1d6 + 6</button>
          </div>
        </div>

        <div class="field">
          <span>SORTE (atual)</span>
          <input id="inpLuckCur" type="number" min="0" readonly />
        </div>

        <div class="field">
          <span>MEDO (máx)</span>
          <div class="row">
            <input id="inpFearMax" type="number" min="0" readonly />
            <button class="btn" id="rollFear" type="button">Rolar 1d6 + 6</button>
          </div>
          <small class="hint">MEDO começa em 0 e vai subindo. Se atingir o máximo, você morre de medo.</small>
        </div>

        <div class="field">
          <span>MEDO (atual)</span>
          <input id="inpFearCur" type="number" min="0" readonly />
        </div>
      </div>

      <div class="footerRow">
        <button class="btn btn--primary" id="btnStart" type="button">Começar a aventura</button>
        <div class="diceLog" id="diceLog" aria-live="polite"></div>
      </div>
    </section>

    <section class="panel" id="screenGame" hidden>
      <div class="sceneHead">
        <h1 id="sceneTitle">Cena</h1>
        <p class="muted" id="sceneMeta"></p>
      </div>

      <article class="sceneText" id="sceneText"></article>

      <div class="choices" id="choices"></div>

      <div class="tools">
        <button class="btn btn--ghost" id="btnTestLuck" type="button">Testar Sorte (2d6)</button>
        <button class="btn btn--ghost" id="btnAddFear" type="button">+1 Medo</button>
        <button class="btn btn--ghost" id="btnHeal" type="button">+2 Vigor</button>
      </div>

      <p class="muted tiny">
        Dica: o jogo salva automaticamente. Atualizar a página mantém seu progresso.
      </p>
    </section>
  </main>

  <dialog id="dlgRules">
    <div class="dlg">
      <div class="dlg__head">
        <h2>Regras rápidas</h2>
        <button class="btn btn--ghost" id="btnCloseRules" type="button">Fechar</button>
      </div>
      <div class="dlg__body">
        <p><b>HABILIDADE</b> reflete sua experiência em combate. <b>RESISTÊNCIA</b> (VIGOR) indica quanto você aguenta. <b>SORTE</b> indica o quão sortudo você é.</p>
        <p><b>Medo:</b> começa em 0 e sobe. Se o MEDO atual atingir o MEDO máximo, você morre de medo.</p>

        <h3>Batalhas (resumo)</h3>
        <ol>
          <li>Role 2d6 para a criatura e some a HABILIDADE dela = Força de Ataque.</li>
          <li>Role 2d6 para você e some sua HABILIDADE atual = sua Força de Ataque.</li>
          <li>Quem tiver maior Força, fere (2 de dano). Empate: próxima rodada.</li>
          <li>Você pode <b>Testar Sorte</b> após um ferimento para aumentar dano (se você feriu) ou reduzir dano (se você foi ferido). Cada teste reduz sua SORTE atual em 1.</li>
          <li>Se RESISTÊNCIA chegar a 0, você morre.</li>
        </ol>

        <p class="muted tiny">Texto e numeração do livro-jogo foram importados do seu arquivo .odt.</p>
      </div>
    </div>
  </dialog>

  <script src="game.js"></script>
</body>
</html>
